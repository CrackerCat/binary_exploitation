int main(int argc,char *param_2){
  int i;
  uint u;
  undefined4 uVar1;
  undefined8 uVar2;
  undefined *ptr;
  long n;
  undefined8 *p;
  long in_FS_OFFSET;
  undefined8 data [16];
  undefined input [128];
  undefined stackvar [64];
  undefined st [72];
  n = 0x10;
  p = data;
  while (n != 0) {
    n -= 1;
    *p = 0;
    p += 1;
  }
  puts("###");
  printf("### Welcome to %s!\n",*param_2);
  puts("###");
  puts(
      "This challenge allows you to perform various heap operations, some of which may involve theflag."
      );
  puts(
      "Through this series of challenges, you will become familiar with the concept of heapexploitation.\n"
      );
  printf("This challenge can manage up to %d unique allocations.\n\n",0x10);
  while( true ) {
    while( true ) {
      while( true ) {
        while( true ) {
          while( true ) {
            while( true ) {
              while( true ) {
                while( true ) {
                  printf(
                        "[*] Function(malloc/free/puts/scanf/stack_free/stack_scanf/stack_malloc_win/quit): "
                        );
                  scanf("%127s",input);
                  i = strcmp(input,"malloc");
                  if (i != 0) break;
                  printf("Index: ");
                  scanf("%127s",input);
                  u = atoi(input);
                  if (0xf < u) { printf("allocation_index < 16"); }
                  printf("Size: ");
                  scanf("%127s",input);
                  uVar1 = atoi(input);
                  printf("[*] allocations[%d] = malloc(%d)\n",u,uVar1);
                  uVar2 = malloc(uVar1);
                  data[u] = uVar2;
                  printf("[*] allocations[%d] = %p\n",u,data[u]);
                }
                i = strcmp(input,&free);
                if (i != 0) break;
                printf("Index: ");
                scanf("%127s",input);
                u = atoi(input);
                printf("[*] free(allocations[%d])\n",u);
                free(data[u]);
              }
              i = strcmp(input,&puts);
              if (i != 0) break;
              printf("Index: ");
              scanf("%127s",input);
              u = atoi(input);
              printf("[*] puts(allocations[%d])\n",u);
              printf("Data: ");
              puts(data[u]);
            }
            i = strcmp(input,"scanf");
            if (i != 0) break;
            printf("Index: ");
            scanf("%127s",input);
            u = atoi(input);
            uVar1 = malloc_usable_size(data[u]);
            sprintf(input,"%%%ds",uVar1);
            printf("[*] scanf(\"%%s\", %p, notebook[%d])\n",input,u);
            scanf(input,data[u],data[u]);
          }
          i = strcmp(input,"stack_free");
          if (i != 0) break;
          printf("[*] free(%p)\n",st);
          free(st);
        }
        i = strcmp(input,"stack_scanf");
        if (i != 0) break;
        printf("[*] scanf(\"%%127s\", %p)\n",stackvar);
        // stackvar is only 64 bytes long goes into input so doesn't matter
        scanf("%127s",stackvar);
      }
      i = strcmp(input,"stack_malloc_win");
      if (i != 0) break;
      printf("[*] if (malloc(%d) == %p) win()\n",0xa7,st);
      printf("[?] malloc_usable_size(malloc(%d)) = %d\n",167,168);
      ptr = (char *)malloc(0xa7);
      printf("[*] malloc(%d) = %p\n",167,ptr);
      if (ptr == st) {
        win();
      }
    }
    i = strcmp(input,&quit);
    if (i == 0) break;
    puts("Unrecognized choice!");
  }
    return 0;
}