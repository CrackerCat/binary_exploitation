#!/usr/bin/python3
from pwn import *
s = ssh(user='col', host='pwnable.kr', password='guest', port=2222)
#the function check_password divides the 20 characters
#into 5 4 character strings and converts them to hex and 
#then sums them
#so I divided the hashcode value that I want the password
#to equal into 5 parts(however since the hex wasn't divisible by 5 
#I subtracted 0x01010101 from the hashcode value and added it back in
#(this time divided hashcode-0x01010101 by 4)
p = s.process(executable='./col', argv=['col',' ./col \"\`python -c \"print \'\x01\x01\x01\x01\'*4+\'\xe8\x05\xd9\x1d\'\"\`\"'])
ans = str(p.recvall(timeout=1))
#doesn't work because string formatting
#log.info('Flag: '+ans[ans.find(''):-3])
s.close()